#!/bin/bash
# rt-stats: generate statistics of your RequestTracker 
# Copyright: (C) 2011 Florian Baumann <flo@noqqe.de>
# License: GPL-3 <http://www.gnu.org/licenses/gpl-3.0.txt>
# Date: Tuesday 2011-04-12

### Include configuration
if [ -e conf/rt-stats.conf ]; then
    source conf/rt-stats.conf
    if [ -e conf/rt-stats.local ]; then
        source conf/rt-stats.local
    fi
else
    echo "Error: Could not find config file conf/rt-stats.conf"
    exit 1
fi

# The global sqlopts string is the way to connect to your database.
# Usually you don't have to touch this. 
# To keep this the last line before you start using modules is very important!
stats_sqlopts="--host=$stats_dbhost --port $stats_dbport --user=$stats_dbuser --password=$stats_dbpassword --batch"

### Load modules
echo "RequestTracker-Stats $(date +%B) $(date +%Y)"
echo "==================================================="
echo 

echo "Resolved ticket statistic for this month($(date +%B))"
echo "---------------------------------------------------"
source modules/user-this-month.bash
echo

echo "Resolved ticket statistic for this year ($(date +%Y))"
echo "---------------------------------------------------"
source modules/user-this-year.bash
echo 

echo "Ticket status for this month ($(date +%B))"
echo "---------------------------------------------------"
source modules/ticket-actions-this-month.bash 
echo 

echo "Ticket status for this year ($(date +%Y))"
echo "---------------------------------------------------"
source modules/ticket-actions-this-year.bash 
echo 

echo "Queues for this month ($(date +%B))"
echo "---------------------------------------------------"
source modules/queue-this-month.bash
echo 

echo "Queues for this year ($(date +%Y))"
echo "---------------------------------------------------"
source modules/queue-this-year.bash
echo 

echo "Most active creators for this month ($(date +%B))"
echo "---------------------------------------------------"
source modules/creators-this-month.bash 
echo 

echo "Most active creators for this year ($(date +%Y))"
echo "---------------------------------------------------"
source modules/creators-this-year.bash 
echo 

echo "Monthly activity by user for this year($(date +%Y))"
echo "---------------------------------------------------"
source modules/user-activity.bash 
echo 

### Trailing informations 

echo "---------------------------------------------------"
echo "This stats were generated by requesttracker-stats"
echo "http://github.com/noqqe/requesttracker-stats"
echo
